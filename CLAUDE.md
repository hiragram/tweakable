# CLAUDE.md

このファイルはClaude Code (claude.ai/code) がこのリポジトリで作業する際のガイダンスを提供します。

## プロジェクト概要

レシピ分析・買い物リストアプリ

## 要件定義・背景・MVPなどのドキュメント

- ハッカソン概要: @docs/hackathon.md
- ハッカソンの題材となる要件: @docs/briefs.md
- このプロジェクトで作るアプリの要件・MVP: @docs/mvp.md
- 勝つためのガイド: @docs/winning-guide.md
- 提出ガイド: @docs/submission-guide.md
- RevenueCat統合ガイド: @docs/revenuecat-integration.md
- パートナーツール（Shipping Container）: @docs/shipping-container.md

## [重要]このプロジェクトの背景

- 上述のハッカソンに参加するためのプロジェクトである。
- iOSアプリのXcodeプロジェクトについて、Okumukaという既存のアプリのプロジェクト構造を流用する。
- Okumukaの完全なXcodeプロジェクトをまずこのリポジトリに持ち込んで、これをベースに新しい画面を追加したりこちらのプロジェクトで不要な実装を削ったりしていく。

- OkumukaのCLAUDE.md: @docs/old-CLAUDE.md
    - OkumukaのCLAUDE.mdをそのままコピペしたもの。
- 開発ルールについては従いつつ、Okumuka固有の記載は適宜無視してもよい。

## 開発環境

### シミュレータ

- xcodebuildでテストやビルドを実行する際は **iPhone 17 Pro** シミュレータを使用すること
- iPhone 16シリーズのシミュレータはインストールされていないため使用不可

### Claude Code設定

- `.claude/settings.json` はプロジェクト共通の設定ファイル
- この設定ファイルを変更した場合は、**必ずコミットに含めること**
- 各開発者（人間・Claude問わず）が同じ設定で作業できるようにするため

## コードレビュー（プッシュ前の必須プロセス）

コードをプッシュする前に、必ずコードレビューを受けること。

### 手順

1. **レビュー実行**: `code-review` プラグインの `review-local` スキル（`/review-local`）を使用
2. **指摘対応**: レビューで指摘された事項に対して必要な修正を行う
3. **再レビュー**: 修正後、再度 `/review-local` を実行
4. **繰り返し**: 指摘がゼロになるまで 2-3 を繰り返す
5. **プッシュ**: 指摘がなくなって初めてプッシュ可能

### 指摘を先送りする場合のルール

コードレビューで指摘された内容のうち、将来的には対応すべきだが今は対応しないと判断するものについては、以下のルールに従うこと：

1. **GitHub issueを必ず作成する**
   - 例: MVPでは不要と判断できる機能追加、リファクタリング提案など
2. **issueには現在のコミットハッシュを必ず記載する**
   - 問題を抱えたコードがどの時点のものかを追跡可能にするため
   - 例: `この問題は commit abc1234 で発生`

**注意**: 指摘が残っている状態でのプッシュは禁止。

## CI（GitHub Actions）

### コンフリクトがあるとCIは実行されない

PRにmainブランチとのコンフリクトがある場合、GitHub ActionsのCIワークフローは開始されない。
`gh pr checks` で "no checks reported" と表示される場合は、まずコンフリクトの有無を確認すること。

```bash
# コンフリクトの確認
gh pr view --json mergeable
```

コンフリクトがある場合は、mainをマージするかリベースして解消してからプッシュし直す。

## レガシーView（Okumuka由来）

`*_Okumuka` サフィックスが付いたViewは、元のOkumukaアプリから流用したコンポーネントです。
新しいアプリの画面を実装する際にこれらを参考にできますが、新しい画面には `_Okumuka` サフィックスを付けないでください。

これらのViewはスナップショットテスト対象外です（`.prefireEnabled()` が削除されています）。
